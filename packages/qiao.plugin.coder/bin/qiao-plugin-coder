#!/usr/bin/env node

'use strict';

var qiaoPluginCli	= require('qiao.plugin.cli');
var qiaoPluginCoder = require('../lib/qiao.plugin.coder.js');

// init
async function init(){
	// print
	console.log('qiao.plugin.coder, generate server and browser code.');
	console.log();
	console.log('code list : https://github.com/insistime/qiao.plugin.coder#01');
	console.log();
	
	// code
	var codeAnswers = await qiaoPluginCli.ask([{
	    type	: 'list',
	    name	: 'code',
	    message	: 'select code number:',
	    choices	: ['01', '02']
	},{
		type		: 'input',
		name		: 'tableName',
		message		: 'input table name:',
		validate	: function(input){
			var done = this.async();
			
			if(!input){
				done('need table name');
		        return;
			}
			
			done(null, true);
		}
	},{
	    type		: 'input',
	    name		: 'destFolder',
	    message		: 'input destination folder path:',
	    validate	: function(input){
			var done = this.async();
			
			if(!input){
				done('need destination folder path');
		        return;
			}
			
			done(null, true);
		}
	}]);
	
	if(codeAnswers.code == '01'){
		var destFolder 	= codeAnswers.destFolder;
		var tableName	= codeAnswers.tableName;
		qiaoPluginCoder.genServerCode(destFolder, tableName);
	}
}

// init
init();